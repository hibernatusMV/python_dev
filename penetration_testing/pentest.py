import subprocess
import socket
import platform

from datetime import datetime
gateway = input("Enter the Network Address: ")
net = gateway.split('.')
sep = '.'

net_addr = net[0] + sep + net[1] + sep + net[2] + sep
net_start = 0
net_end = 255
os = platform.system()

if (os == "Windows"):
   ping = "ping -n 1 -w 250 "
elif (os == "Linux"):
   #ping = "ping -c 1 "
   ping = "ping -c 1 -n -i 0.2 -W1 "
else :
   ping = "ping -c 1 "

time_start = datetime.now()
print ("Scanning in Progress:")
print("IP".ljust(20), "Hostname")
print("-" * 40)
    
for ip in range(net_start, net_end):
   addr = net_addr + str(ip)
   comm = ping + addr
   response = subprocess.Popen(comm, stdout=subprocess.PIPE)
   response.wait()

   if not response.poll():
        # IP is live
        try:
            host = socket.gethostbyaddr(addr)
            hostname = host[0]
        except socket.herror:
            # Error handling if hostname is not available
            hostname = "NA"

        print(addr.ljust(20), hostname)

time_end = datetime.now()
time_total = time_end - time_start
print ("Scanning completed in: ", time_total)